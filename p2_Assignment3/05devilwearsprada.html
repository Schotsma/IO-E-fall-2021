<html>
<head>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.4.5/p5.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.4.5/addons/p5.dom.js"></script>
	<script src="../lib/p5.speech.js"></script>
	<script>
    
//Code referencing parts from sketch called speech recognition_basic by xinxin https://editor.p5js.org/xinxin/sketches/BBRBr1p87


let myVoice = new p5.Speech(); //new p5 speech voice


const myRec = new p5.SpeechRec(); // initiate a new speech rec object

myRec.continuous = true; // doing conitinuous voice rec
myRec.intrimResults = false; // allow partial reading of the speech

function setup() {
  createCanvas(windowWidth, windowHeight); //make the canvas the whole width and height of the window
  textAlign(CENTER);
  textSize(18);
  
  textSize(20);
  fill(150, 150, 150);
  text('Say Miranda', windowWidth/2, 50);
  
  myRec.start(); // start engine
  
  myRec.onResult = parseResult; //do the following action in the parseResult
  
   myRec.onEnd = restartRec; //when the recognition ends, start recognizing the voice again to continue to the next line in the script
}


function draw (){
  //notihg is being drawn in here
}

function parseResult() { //this function is deciding what to do with the information that is being recognized by the system
  // background(bg);
  
  if (myRec.resultString != null){
  text(myRec.resultString, windowWidth/2, windowHeight/6); //display the text that the system is currently recognizing so that the user knows when to speak
  } else {
     
  }
  
  // say "background yellow"
  if (myRec.resultString == "Miranda"){ //lines that user will be saying taken from a section in the Devil Wear Prada Script, on imdsb.com
    background(253, 199, 138);
    
   myVoice.speak('Andrea');  //lines that system responds with after the user says the correct phrase
   textSize(15);
   fill(150, 150, 150);
   text('Say Next Line:', windowWidth/2, 100);
   text('Miranda, about last night, I--', windowWidth/2, 150);

  } else if (myRec.resultString == "Miranda about last night I"){
    myVoice.speak(' I need the new Harry Potter book for the twins');
    background(253, 199, 138);
   textSize(15);
   fill(150, 150, 150);
   text('Say Next Line:',windowWidth/2, 100);
   text('Of course', windowWidth/2, 150);

  } else if (myRec.resultString == "of course"){
    myVoice.speak(' Did you fall down and smack your little head on the pavement?');
    background(253, 199, 138);
   textSize(15);
   fill(150, 150, 150);
   text('Say Next Line:', windowWidth/2, 100);
   text('Not that I can recall',windowWidth/2, 150);
  } else if (myRec.resultString == "not that i can recall"){

    myVoice.speak(' We have all the published Harry Potter books. The girls want to know what happens next.');
    background(253, 199, 138);

   textSize(15);
   fill(150, 150, 150);
   text('Say Next Line:', windowWidth/2, 100);
   text('So you want the... unpublished manuscript.', windowWidth/2, 150);
  }
  
}
 
function restartRec() { //restart the recognition process after the users voice has been recognized
  print("end");
  myRec.start();
}

</script>
</head>
<body>
</body>
</html>
